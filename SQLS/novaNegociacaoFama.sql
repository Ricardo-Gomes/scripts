--inclusao de todos os registros que devem ser renegociados
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586872478950,5725490327,162.93,167.52,167.52,167.52,167.52);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586821200999,7017684362,196.94,218.39,218.39,218.39,218.39);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586870651787,62506960325,150.94,164.68,164.68,164.68,164.68);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586889391200,5303640345,152.26,166.22,166.22,166.22,166.22);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586848884762,6414862355,194.21,208.30,208.30,208.30,208.30);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586859997096,2686518332,107.16,113.57,113.57,113.57,113.57);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586845632021,5494545350,151.97,165.88,165.88,165.88,165.88);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,62015563984661,1673583326,149.91,163.47,163.47,163.47,163.47);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586878552813,3387294379,136.86,150.07,150.07,150.07,150.07);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586890284476,61320100333,176.45,187.61,187.61,187.61,187.61);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586873244414,46452052349,553.01,615.19,615.19,615.19,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586833526941,6998172346,225.17,235.79,235.79,235.79,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586895687182,2883676348,785.32,878.34,878.34,878.34,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586861356161,5622908345,247.15,273.26,273.26,273.26,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586848354481,4520406390,173.07,189.36,189.36,189.36,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586864010984,84108053320,217.94,223.51,223.51,223.51,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586830453701,44267754349,196.28,215.65,215.65,215.65,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,62015584129204,2282874307,241.61,251.25,251.25,251.25,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586860888136,61262024307,187.14,205.29,205.29,205.29,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,62015588524815,63735466320,160.09,174.65,174.65,174.65,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586848974675,65109988315,535.84,592.85,592.85,592.85,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586896024288,60408795301,174.12,174.69,174.69,174.69,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586883407292,4691773304,209.71,226.33,226.33,226.33,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,62015525872601,60498626300,120.90,124.56,124.56,124.56,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586870767781,3028922304,172.06,183.47,183.47,183.47,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586861402299,3309003310,196.09,206.71,206.71,206.71,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586855160593,70547530382,260.49,281.31,281.31,281.31,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586820883246,5512869388,234.11,240.46,240.46,240.46,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586818463169,6176762324,182.32,199.83,199.83,199.83,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586831495223,60826747310,155.07,153.41,153.41,153.41,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,62015515950280,60560072350,155.34,169.27,169.27,169.27,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586863396794,7260793325,182.22,186.63,186.63,186.63,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,62015541744818,60417096380,108.43,112.63,112.63,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,62015530639996,61136164367,187.30,189.72,189.72,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586846349492,60457218371,260.77,267.24,267.24,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586880756544,61210117347,269.63,276.77,276.77,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586822531384,60404351352,228.94,231.95,231.95,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,62015533418255,62653652315,270.55,286.33,286.33,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,60586898530712,61236167309,168.18,178.27,178.27,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,60586899098711,5439267379,191.33,188.14,188.14,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,60586892837659,1397235365,196.51,209.39,209.39,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,62015512929494,1467807362,343.83,366.83,366.83,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586868332445,2580798358,206.11,219.93,219.93,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586874999877,5422369319,241.37,243.40,243.40,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,62015578845370,2252471352,232.42,244.44,244.44,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586822070976,5993279362,233.33,234.97,234.97,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586862970754,89620305353,319.37,339.96,339.96,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,60586845612752,1173125337,202.23,205.44,205.44,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586854462102,60740049356,209.58,219.36,219.36,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586897078525,60573857300,193.07,201.22,201.22,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,62015520489978,6271703313,173.90,184.55,184.55,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586859628626,60409213314,200.45,209.32,209.32,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586874984038,5145105363,178.85,185.59,185.59,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586875139513,6374311388,228.45,240.08,240.08,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,62015597189711,1646546318,449.07,482.43,482.43,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586876536070,4377566377,266.03,281.37,281.37,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,62015537747582,84364998320,196.03,197.00,197.00,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,62015520261648,5259714326,123.79,129.51,129.51,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,62015580460325,5404373369,170.65,175.45,0.00,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586882602555,5190497305,198.68,211.59,0.00,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586815173207,6178729375,194.25,196.33,0.00,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(199,60586827645743,60395557348,130.69,129.54,0.00,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586875500081,4621963309,210.52,245.80,245.80,245.80,245.80);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586867559914,60035574356,213.41,234.44,234.44,0.00,0.00);
insert into sc_cbe.acordo_funcionario_empresa(empresa, cartao, cpf, valor_entrada, valor_parcela_1, valor_parcela_2, valor_parcela_3, valor_parcela_4) values(198,60586839923536,4112624328,195.10,227.80,227.80,227.80,227.80);

--consultando apenas os registros que tiveram pagamento da empresa FAMA
select 'update sc_cbe.acordo_funcionario_empresa set cd_acr = null where id = ' || afe.id || ';' as comando, acr.*
       --afe.empresa, afe.cartao, afe.cpf, afe.valor_entrada, acr.vlr_ent_acr, afe.valor_parcela_1, acr.vlr_prc_acr, afe.valor_parcela_2, afe.valor_parcela_3, afe.valor_parcela_4, acr.*
from sc_cbe.acordo_funcionario_empresa afe
     inner join sc_cad.tbl_cun cun on cun.nr_cpf_cnpj_cun = afe.cpf
     inner join sc_cbe.tbl_dvd dvd on cun.cd_cun = dvd.cd_cun and dvd.nsu_org_dvd = afe.cartao
     inner join sc_cbe.tbl_acr acr on dvd.cd_acr = acr.cd_acr
where cartao in (60586821200999, 60586848884762, 60586890284476, 60586872478950, 60586889391200, 60586870651787, 62015563984661, 60586878552813, 60586859997096,
                 60586867559914, 60586839923536, 60586895687182, 60586848974675, 60586873244414, 60586855160593, 60586861356161, 62015584129204, 60586820883246,
                 60586833526941, 60586883407292, 60586830453701, 60586860888136, 60586818463169, 60586863396794, 60586896024288, 60586848354481, 60586870767781,
                 60586831495223, 60586864010984, 60586862970754, 60586880756544, 60586876536070, 60586846349492, 60586874999877, 60586822070976, 62015578845370, 
                 60586822531384, 60586875139513, 60586854462102, 60586868332445, 60586859628626, 62015537747582, 60586897078525, 60586874984038, 60586875500081,
                 60586882602555, 60586815173207)
  and acr.st_acr = 5;
  
--consultando apenas os registros que tiveram pagamento da empresa G1
select 'update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = ' || acr.vlr_ent_acr || ' where id = ' || afe.id || ';' as comando, acr.cd_acr, acr.vlr_ent_acr, afe.valor_entrada, afe.valor_parcela_1
       --afe.empresa, afe.cartao, afe.cpf, afe.valor_entrada, acr.vlr_ent_acr, afe.valor_parcela_1, acr.vlr_prc_acr, afe.valor_parcela_2, afe.valor_parcela_3, afe.valor_parcela_4, acr.*
from sc_cbe.acordo_funcionario_empresa afe
     inner join sc_cad.tbl_cun cun on cun.nr_cpf_cnpj_cun = afe.cpf
     inner join sc_cbe.tbl_dvd dvd on cun.cd_cun = dvd.cd_cun and dvd.nsu_org_dvd = afe.cartao
     inner join sc_cbe.tbl_acr acr on dvd.cd_acr = acr.cd_acr
where cartao in (62015598053703, 62015566484981, 60586892837659, 60586899098711, 60586827645743,
                 62015512929494, 62015597189711, 60586898530712, 62015580460325, 62015530639996,
                 62015533418255, 62015520261648, 62015588524815, 62015541744818, 60586845612752,
                 62015525872601, 62015520489978, 62015515950280)
  and acr.st_acr = 4;

update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = 121.64 where id = 63;
update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = 154.19 where id = 21;
update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = 168.00 where id = 52;
update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = 102.53 where id = 34;
update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = 333.93 where id = 43;
update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = 117.89 where id = 59;
update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = 190.61 where id = 42;
update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = 149.44 where id = 32;
update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = 171.26 where id = 41;
update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = 172.71 where id = 35;
update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = 187.01 where id = 49;
update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = 164.75 where id = 60;
update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = 109.97 where id = 25;
update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = 162.28 where id = 40;
update sc_cbe.acordo_funcionario_empresa set cd_acr = null, valor_entrada = 260.65 where id = 39;


insert into sc_cbe.tbl_acr(cd_acr, cd_dvd, st_acr, frm_pgm_acr, vl_mlt_acr, vlr_mra_acr, vlr_dsc_acr, vlr_ent_acr, vlr_cms_acr, qnt_prc_acr, vlr_prc_acr,
                           dt_vnc_ent_acr, dt_vnc_prm_prc_acr, cd_inc_usr, dt_inc_usr, vlr_esp_acr, cd_emc, tx_jrs_acr)
values(vl_codigo_acordo, vl_rg.codigo_divida, 1, 2, 3.0, 2.0, 0.0, vl_rg.valor_entrada, 30.00, vl_qtde_parcelas, vl_rg.valor_parcela_1,
       vp_data_venc_entrada, vp_data_venc_parcela_1, 1, now(), 0, 2, 6.5);

select * from sc_cbe.tbl_prd where cd_acr = 2170

insert into sc_cbe.tbl_prd(cd_prd, cd_acr, nr_prd, vlr_prd, st_prd, dt_vnc_prd, fg_ent_prd, fg_dbt_aut_prd)
values(nextval('sc_cbe.sq_prd'), vl_codigo_acordo, vl_nr_parcela, vl_valor_parcela, 1, vl_data_vencimento, vl_flag_entrada, 'S'); 

select afe.id, dvd.cd_dvd as codigo_divida, afe.valor_entrada, afe.valor_parcela_1, afe.valor_parcela_2, 
                       afe.valor_parcela_3, afe.valor_parcela_4, afe.valor_parcela_5, afe.valor_parcela_6,
                       afe.valor_parcela_7, afe.valor_parcela_8, afe.valor_parcela_9, afe.valor_parcela_10,
                       afe.valor_parcela_11, afe.valor_parcela_12
                from sc_cbe.acordo_funcionario_empresa afe
                     inner join sc_cad.tbl_cun cun on cun.nr_cpf_cnpj_cun = afe.cpf
                     inner join sc_cbe.tbl_dvd dvd on cun.cd_cun = dvd.cd_cun and dvd.nsu_org_dvd = afe.cartao
                where afe.cd_acr is null
                  --and dvd.cd_dvd = 11794
                  and afe.empresa = 198
                  and dvd.st_dvd = 1

select * from sc_cbe.tbl_acr where cd_acr = 2375;
select * from sc_cbe.tbl_prd where cd_prd = 7307;
update sc_cbe.tbl_acr set vlr_ent_acr = vlr_ent_acr - 9.9 where cd_acr = 2375
update sc_cbe.tbl_prd set vlr_prd = vlr_prd - 9.9 where cd_prd = 7307;

update sc_fcr.tbl_fcr set st_fcr = 6 where cd_fcr = 3773983;

select sc_scan_cbe.cobrar_parcela_divida_cartao(60586854462102);

select * from sc_cbe.tbl_dvd where cd_dvd = 11794

update sc_cbe.tbl_dvd set st_dvd = 2, cd_acr = 2306 where cd_dvd = 11794;

select * from sc_cbe.acordo_funcionario_empresa where cartao = 60586872478950


select sc_cbe.gerar_acordo_funcionario_empresa(199, '2019-10-08', '2019-11-08')
    vp_empresa integer,
    vp_data_venc_entrada date,
    vp_data_venc_parcela_1 date)  

select afe.id, dvd.cd_dvd as codigo_divida, afe.valor_entrada, afe.valor_parcela_1, afe.valor_parcela_2, 
                       afe.valor_parcela_3, afe.valor_parcela_4, afe.valor_parcela_5, afe.valor_parcela_6,
                       afe.valor_parcela_7, afe.valor_parcela_8, afe.valor_parcela_9, afe.valor_parcela_10,
                       afe.valor_parcela_11, afe.valor_parcela_12
                from sc_cbe.acordo_funcionario_empresa afe
                     inner join sc_cad.tbl_cun cun on cun.nr_cpf_cnpj_cun = afe.cpf
                     inner join sc_cbe.tbl_dvd dvd on cun.cd_cun = dvd.cd_cun and dvd.nsu_org_dvd = afe.cartao
                where afe.cd_acr is null
                  --and dvd.cd_dvd = 11794
                  and afe.empresa = 198

select dvd.cd_dvd as codigo_divida, afe.valor_entrada, afe.valor_parcela_1, afe.valor_parcela_2, 
                       afe.valor_parcela_3, afe.valor_parcela_4, afe.valor_parcela_5, afe.valor_parcela_6,
                       afe.valor_parcela_7, afe.valor_parcela_8, afe.valor_parcela_9, afe.valor_parcela_10,
                       afe.valor_parcela_11, afe.valor_parcela_12
                from sc_cbe.acordo_funcionario_empresa afe
                     inner join sc_cad.tbl_cun cun on cun.nr_cpf_cnpj_cun = afe.cpf
                     inner join sc_cbe.tbl_dvd dvd on cun.cd_cun = dvd.cd_cun and dvd.nsu_org_dvd = afe.cartao
                where afe.cd_acr is null
                  and afe.empresa = 198   
                  and dvd.st_dvd = 1

select * from sc_cad.tbl_fnc limit 10

select afe.id, afe.cartao, cun.nm_cun as nome, fnc.nr_idt_fnc as matricula, afe.cpf, afe.valor_entrada, afe.valor_parcela_1
from sc_cbe.acordo_funcionario_empresa afe
     inner join sc_cad.tbl_cun cun on cun.nr_cpf_cnpj_cun = afe.cpf
     inner join sc_opr.tbl_crt crt on afe.cartao = crt.cd_crt
     inner join sc_cad.tbl_fnc fnc on crt.cd_fnc = fnc.cd_fnc
     inner join sc_cbe.tbl_dvd dvd on cun.cd_cun = dvd.cd_cun and dvd.nsu_org_dvd = afe.cartao
     inner join sc_cbe.tbl_acr acr on afe.cd_acr = acr.cd_acr
where afe.empresa = 198
  and acr.st_acr = 4
  and dvd.st_dvd = 1
order by matricula;

update sc_cbe.acordo_funcionario_empresa afe set valor_entrada = 200.21, cd_acr = null where id = 44;

select sc_cbe.gerar_acordo_funcionario_empresa(198, '2019-10-08', '2019-11-08');

update sc_fcr.tbl_fcr set st_fcr = 6 where cd_fcr = 3773299;

select sc_scan_cbe.cobrar_parcela_divida_cartao(62015580460325);

select * from sc_cad.tbl_dmn where nm_cmp_dmn = 'ST_ACR'

update sc_cbe.tbl_prd
   set st_prd = 2,
       vlr_prd = vlr_pgt_prd
where cd_prd in ( 
select prd.cd_prd
from sc_cbe.tbl_dvd dvd
     inner join sc_cbe.tbl_acr acr on dvd.cd_acr = acr.cd_acr
     inner join sc_cbe.tbl_prd prd on acr.cd_acr = prd.cd_acr
where dvd.st_dvd = 2
  and dvd.cd_emc = 2
  and acr.st_Acr = 2
  AND PRD.ST_PRD = 1
  --and acr.cd_acr = 2341
  and prd.vlr_pgt_prd > 0.0)
  
update sc_cbe.tbl_acr
   set fg_cnc_acr = 'N'
where cd_acr in ( 
select acr.cd_acr
from sc_cbe.tbl_dvd dvd
     inner join sc_cbe.tbl_acr acr on dvd.cd_acr = acr.cd_acr
where dvd.st_dvd = 2
  and dvd.cd_emc = 2
  and acr.st_Acr = 2
  and coalesce(fg_cnc_acr, 'S') = 'S')

SELECT * FROM SC_OPR.TBL_CNT_CRT WHERE CD_CRT = 62015580460325;

select * from sc_cbe.tbl_dvd where cd_acr = 2384

update sc_cbe.tbl_acr set st_acr = 3 where cd_acr = 2395;
update sc_cbe.tbl_dvd set st_dvd = 3 where cd_acr = 2395;
